[TOC]

# 概述
![[Pasted image 20220212161609.png]]

* 作用
1. 管理系统的硬件、软件、数据资源
2. 控制程序运行
3. 人机之间的接口
4. 应用软件与硬件之间的接口

* 包含以下管理
1. 进程管理
2. 存储管理
3. 文件管理
4. 作业管理
5. 设备管理

# 进程管理

## 进程的状态
> 为进程赋予状态，是为了方便管理

![[绘图/操作系统基本原理-进程管理-进程状态演变和流程.md]]

1. 等待事件=缺资源
2. 等待不能回到运行状态，需到就绪状态，排队等待cpu调度
3. cpu执行任务，采用时间片轮转，限制了执行时间，即使该任务还没执行完成，也会被暂停
4. **由三态模型演变成五态模型，是因为不足以满足场景，比如挂起**

## 前驱图
>描述的是哪些步骤可并行执行，哪些步骤有先后约束关系

![[绘图/操作系统基本原理-进程管理-前驱图.md]]

## 进程的同步与互斥
> 互斥，同一时刻，只能进行一个任务，任务之间无关联，所以可以乱序执行
> 同步，同一时刻可以执行多个任务，但任务A需要依赖任务B的数据才能继续执行，等待完毕后，一起结束整体任务

## PV操作
* 临界资源
> 每个进程，需要以互斥方式来访问的资源，称为临界资源

* 临界区
> 每个进程中访问临界资源的那段代码，称为临界区

* 信号量
> 特殊变量

-----

PV流程图[[不懂]]
![[绘图/操作系统基本原理-进程管理-PV操作.md]]

> 大概流程：V代表发送消息，P代表接收消息并处理


* **例子**

某书店有一个收银员,该书店最多允许n个购书者进入。将收银员和购书者看作不同的进程，其工作流程如下图所示。利用PV操作实现该过程，设置信号量S1、S2和Sn，初值分别为0、0、n。则图中al和a2应填入(1)，图中bl和b2应填入(2)。

![[Pasted image 20220305110422.png]]
(1) A.  V(S1)、P(S2)， B.  V(Sn)、P(Sn) ，C.  P(S1)、V(S2)，D.  P(S2)、V(S1) 
(2) A.  P(Sn)、V(S2)，B.  V(Sn)、P(S2) ，C.  P(S1)、V(S2)，D.  P(S2)、V(S1)

**答案：A、C**

### PV操作与前驱图
- 根据[[#前驱图]]，转换成相应的进程，进行PV操作
![[Pasted image 20220305111819.png]]

* **例子**
进程P1、P2、P3、P4、P5的前趋图如下图所示。若用PV操作控制进程并发执行的过程，则需要设置4个信号量S1、S2、S3和S4,且信号量初值都等于零。图中a和b应分别填写(1)，c和d应分别填写(2)，e和f应分别填写(3)
(1) A.  P(S1)和P(S2)          B.  P(S1)和V(S2)
     C.  V(S1)和V(S2)          D.  V(S1)和P(S2)
(2) A.  P(S1)、P(S2)和V(S3)、V(S4)          B.  P(S1)、P(S2)和P(S3)、P(S4)
      C.  V(S1)、V(S2)和P(S3)、 P(S4)         D.  V(S1)、V(S2)和V(S3)、V(S4)
(3) A.  P(S3)和P(S4)          B.  P(S3)和V(S4)
      C.  V(S3)和V(S4)          D.  V(S3)和P(S4)

**答案：C、A、A**
![[Pasted image 20220305112726.png]]

## 死锁问题
### 死锁的原因
> 如果一个进程在等待一个不可能的事，则进程就死锁，多个进程死锁，进而导致系统死锁

**不可能的事有如下原因：** ^f70d62
1. 互斥（进程之间互斥执行，资源不共享）
2. 保持和等待（自己资源不给别人，别人资源也不给我）
3. 不剥夺（系统不会剥夺进程资源给其它进程）
4. 环路等待（进程A需要进程B的资源、B进程需要C进程的资源、C进程需要A进程的资源）

* **最低多少个资源才不会导致死锁**

> 比如k个进程，一个进程需要n个资源才能完成执行，那么至少需要`k * (n-1) + 1` 个资源才不会死锁

* **预防死锁，需要打破这四个条件**[[#^f70d62]]

* **避免死锁的两种方式**
1. 有序资源分配法（只能按顺序执行，效率低）
2. 银行家算法[[#银行家算法]]（选择出最优解，效率高）

### 银行家算法
* **基于资源分配的原则**

1. 当一个进程申请的所需最大需求资源数，不超过系统的总资源数，允许该进程的申请
2. 可允许进程分期请求资源，但总数不能超过最大需求资源数
3. 当系统现有资源无法满足该进程，可延迟分配，但总能在有限时间得到资源

* **怎样的分配顺序，才能保证不死锁**
1. 题目
![[Pasted image 20220308225514.png]]

2. 解题过程，
![[Pasted image 20220308225523.png]]

![[Pasted image 20220308225530.png]]