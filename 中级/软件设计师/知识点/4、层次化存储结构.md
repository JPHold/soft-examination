[TOC]

# 分类
速度由高到低、容量由小到大：
CPU、Cache、主存、外存

**局部性原理是层次化存储结构的支撑**

```chartsview
#-----------------#
#- chart type    -#
#-----------------#
type: OrganizationTreeGraph

#-----------------#
#- chart data    -#
#-----------------#
data:
  id: "root"
  label: "存储结构"
  children:
    - id: "1"
      label: "CPU"
	  children:
        - id: "1-1"
          label: "寄存器"
	- id: "2"
      label: "Cache" 
	- id: "3"
      label: "主存（内存）"
	  children:
        - id: "3-1"
          label: "随机存储器（RAM）"
		- id: "3-2"
          label: "只读存储器（ROM）"   
	- id: "4"
      label: "外存（辅存）" 
      children:
        - id: "4-1"
          label: "硬盘"
		- id: "4-2"
          label: "光盘" 
		- id: "4-3"
          label: "U盘" 
		  

#-----------------#
#- chart options -#
#-----------------#
options: {}
```
                  
# 局部性原理
避免了抖动[[不懂]]

## 时间局部性
> 一段时间内多次被访问的内容，会一直被缓存下来，直接从缓存读取

## 空间局部性
> 缓存内容时，附近区域的内容也一并缓存

## 工作集理论
进程运行时被频繁访问的页面集合

# Cache
## 概念
涉及到命中和失效（未命中）
因为容量不多，所以就会有命中缓存和没命中缓存
>没命中就从主存中拿

## 公式
### 平均周期
以读为例子：h为访问命中率，t1为Cache的周期时间，t2为主存的周期时间
`t3 = h * t1 + (1 - h) * t2`

## 映像
| 分类         | 描述                                                  |
| ------------ | ----------------------------------------------------- |
| 直接相联映像 | 硬件电路较简单，但冲突率很高                          |
| 全相联映像   | 电路难于设计和实现，只适用于小容量的Cache，冲突率较低 |
| 组相联映像   | 直接相联和全相联的折中                                |
| 地址映像     | 将主存和Cache的存储空间划分为若干个大小相同的页（块） |

### 直接相联映像
> Cache结构只分页
> 主存结构先分区，区内以Cache的总页数进行分页
> 主存中每一页只能放到对应Cache的页中

[[Cache-直接相联映像结构]]

### 全相联映像
> 主存结构和Cache结构都只分页
> 主存的每一页随意放到Cache中

[[Cache-全相联映像结构]]


### 组相联映像
> 主存结构先分区，再分组，组中包含多个页
> Cache结构先分组，组中包含多个页
> 组中采用全相联映像

[[Cache-组相联映像结构]]

# 主存的编址
> 涉及到计算地址单元有多少个，需要多少个芯片