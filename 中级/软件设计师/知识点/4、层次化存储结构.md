[TOC]

# 分类
速度由高到低、容量由小到大：
CPU、Cache、主存、外存

**局部性原理是层次化存储结构的支撑**

```chartsview
#-----------------#
#- chart type    -#
#-----------------#
type: OrganizationTreeGraph

#-----------------#
#- chart data    -#
#-----------------#
data:
  id: "root"
  label: "存储结构"
  children:
    - id: "1"
      label: "CPU"
	  children:
        - id: "1-1"
          label: "寄存器"
	- id: "2"
      label: "Cache" 
	- id: "3"
      label: "主存（内存）"
	  children:
        - id: "3-1"
          label: "随机存储器\n（RAM）"
		  children:
			- id: "3-1-1"
			  label: "DRAM\n（Dynamic RAM\n,动态RAM）"
			- id: "3-1-2"
			  label: "SRAM\n（Static RAM\n,静态RAM）"
		- id: "3-2"
          label: "只读存储器\n（ROM）"   
		  children:
			- id: "3-2-1"
			  label: "MROM\n（Mask ROM\n,拖模式ROM）"
			- id: "3-2-2"
			  label: "PROM\n（Programmable ROM\n,一次可编程ROM）"
			- id: "3-2-3"
			  label: "EPROM\n（Erasable PROM\n,可擦除的PROM）"
			- id: "3-2-4"
			  label: "闪速存储器\n（flash memory\n,闪存）"
	- id: "4"
      label: "外存（辅存）" 
      children:
        - id: "4-1"
          label: "硬盘"
		- id: "4-2"
          label: "光盘" 
		- id: "4-3"
          label: "U盘" 
		  

#-----------------#
#- chart options -#
#-----------------#
options: {}
```
                  
# 局部性原理
避免了抖动[[不懂]]

## 时间局部性
> 一段时间内多次被访问的内容，会一直被缓存下来，直接从缓存读取

## 空间局部性
> 缓存内容时，附近区域的内容也一并缓存

## 工作集理论
进程运行时被频繁访问的页面集合

# Cache
## 概念
涉及到命中和失效（未命中）
因为容量不多，所以就会有命中缓存和没命中缓存
>没命中就从主存中拿

## 公式
### 平均周期
以读为例子：h为访问命中率，t1为Cache的周期时间，t2为主存的周期时间
`t3 = h * t1 + (1 - h) * t2`

## 映像
| 分类         | 描述                                                  |
| ------------ | ----------------------------------------------------- |
| 直接相联映像 | 硬件电路较简单，但冲突率很高                          |
| 全相联映像   | 电路难于设计和实现，只适用于小容量的Cache，冲突率较低 |
| 组相联映像   | 直接相联和全相联的折中                                |
| 地址映像     | 将主存和Cache的存储空间划分为若干个大小相同的页（块） |

### 直接相联映像
> Cache结构只分页
> 主存结构先分区，区内以Cache的总页数进行分页
> 主存中每一页只能放到对应Cache的页中

[[Cache-直接相联映像结构]]

### 全相联映像
> 主存结构和Cache结构都只分页
> 主存的每一页随意放到Cache中

[[Cache-全相联映像结构]]


### 组相联映像
> 主存结构先分区，再分组，组中包含多个页
> Cache结构先分组，组中包含多个页
> 组中采用全相联映像

[[Cache-组相联映像结构]]

# 主存的编址
[[重点]]
> 涉及到计算地址单元有多少个，芯片中每个存储单元存储几位才能满足总地址位数

**题目1：**
>内存地址从AC000H到C7FFFH，共有\_K个地址单元
>如果该内存地址按字（16kit）编址，由28片存储芯片构成。已知构成该内存的芯片每片有16K个存储单元，则该芯片每个存储单元存储\_位

**第一个答案：**
1. 为了方便计算，C7FFFH进一位（因16进制，満16进1）得出C8000H；
2. 相减：C8000H-AC000H，因8-C不够减，从左边借1，得出新计算：（8+16）-C，得出结果是12（C等于12，也就是（8+16）-12=12）；
3. 因为被借走1，C降为B，因此最终计算：B(24)000H-AC000H=1C000H
4. K换算成bit（位）：2的10次方，也就是1024
5. 1C000/1024，1C000H需要换算成十进制（采用按权展开法）：1\*16的4次方 + 12 \* 16的3次方 = 65536 + 49152 = 114688，因此最终结果114688/1024= **112**

**第二个答案：**
1. 利用到第一个答案：112，形成计算：地址个数\*地址位数=112 * 16(kit) = 1792
2. 芯片数\*每片芯片的存储单元个数\*每个存储单元的位数（记作x）= 28 * 16 (K) * x
3. 因为是相等的，所以(112 * 16)/(28 * 16 * x) =1；得出**x=4**